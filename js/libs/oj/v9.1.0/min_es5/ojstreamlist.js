!function(){function e(t){"@babel/helpers - typeof";return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function o(e,t,o){return t&&n(e.prototype,t),o&&n(e,o),e}function r(e,t,n){return(r="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var o=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=a(e)););return e}(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function l(t){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var o,r=a(t);if(n){var s=a(this).constructor;o=Reflect.construct(r,arguments,s)}else o=r.apply(this,arguments);return function(t,n){if(n&&("object"===e(n)||"function"==typeof n))return n;return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(t)}(this,o)}}function a(e){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}define(["exports","ojs/ojvcomponent","ojs/ojdatacollection-common","ojs/ojcontext","ojs/ojvcollection","ojs/ojcore-base","ojs/ojkeyset","ojs/ojtreedataprovider","ojs/ojanimation"],function(n,i,u,c,d,h,f,p,y){"use strict";
/**
   * @license
   * Copyright (c) 2014, 2020, Oracle and/or its affiliates.
   * The Universal Permissive License (UPL), Version 1.0
   * as shown at https://oss.oracle.com/licenses/upl/
   * @ignore
   */var v,m=function(e){s(i,d.IteratingDataProviderContentHandler);var n=l(i);function i(e,o,r,s){var l;return t(this,i),(l=n.call(this,e,o,r,s)).root=e,l.dataProvider=o,l.callback=r,l.scrollPolicyOptions=s,l.postRender=function(){l.vnodesCache=l.newVnodesCache,l.newVnodesCache=new Map;var e=l.root.lastElementChild;e&&c.getContext(e).getBusyContext().whenReady().then(function(){if(l.callback){if(l.domScroller){var t=e.querySelectorAll(".oj-stream-list-item"),n=l.root.offsetTop,o=t[0].offsetTop-n,r=t[t.length-1].offsetTop+t[t.length-1].offsetHeight-n;l.domScroller.setViewportRange(o,r)}if(l.domScroller&&!l.domScroller.checkViewport())return}})},l.newItemsTracker=new Set,l.vnodesCache=new Map,l.newVnodesCache=new Map,l}return o(i,[{key:"handleFetchSuccess",value:function(e){null!=e&&this.newItemsTracker.clear(),r(a(i.prototype),"handleFetchSuccess",this).call(this,e)}},{key:"handleItemsUpdated",value:function(e){e.keys.forEach(function(e){this.vnodesCache.delete(e)}.bind(this)),r(a(i.prototype),"handleItemsUpdated",this).call(this,e)}},{key:"handleItemsRemoved",value:function(e){e.keys.forEach(function(e){this.vnodesCache.delete(e)}.bind(this)),r(a(i.prototype),"handleItemsRemoved",this).call(this,e)}},{key:"handleModelRefresh",value:function(){this.vnodesCache.clear(),r(a(i.prototype),"handleModelRefresh",this).call(this)}},{key:"addItem",value:function(e,t,n,o){var r=this.isInitialFetch();null==this.callback.getCurrentItem()&&r&&0==t&&this.callback.setCurrentItem(e);var s=this.renderItem(e,t,n);return this.decorateItem(s,e,t,r,o),s}},{key:"renderItem",value:function(e,t,n){var o=this.vnodesCache.get(e);if(o)return this.newVnodesCache.set(e,{vnodes:o.vnodes}),o.vnodes;for(var r,s=this.callback.getItemRenderer()({data:n,key:e}),i=0;i<s.length;i++){if(1===s[i]._node.nodeType){r=s[i];break}}var l=[r];return this.newVnodesCache.set(e,{vnodes:l}),l}},{key:"decorateItem",value:function(e,t,n,o,r){var s=e[0],i=s._node;if(null!=i){s.key=t,i.key=t,i.setAttribute("key",JSON.stringify(t)),i.setAttribute("role","listitem"),i.setAttribute("tabIndex","-1"),this.getItemStyleClass(r,this.newItemsTracker.has(t),o).forEach(function(e){i.classList.add(e)});var l=this.getItemInlineStyle(r,n,o);Object.keys(l).forEach(function(e){i.style[e]=l[e]})}}},{key:"getItemInlineStyle",value:function(e,t,n){return{}}},{key:"getItemStyleClass",value:function(e,t,n){var o=[];return o.push("oj-stream-list-item"),o}},{key:"renderSkeletonsForLoadMore",value:function(){return this.callback.renderSkeletons(3)}}]),i}(),k=function(e){s(i,d.IteratingTreeDataProviderContentHandler);var n=l(i);function i(e,o,r,s){var l;return t(this,i),(l=n.call(this,e,o,r,s)).root=e,l.dataProvider=o,l.callback=r,l.scrollPolicyOptions=s,l.postRender=function(){l.vnodesCache=l.newVnodesCache,l.newVnodesCache=new Map;var e=l.root.lastElementChild;e&&c.getContext(e).getBusyContext().whenReady().then(function(){l.checkViewport()})},l.getLoadMoreCount=function(){return 3},l.newItemsTracker=new Set,l.vnodesCache=new Map,l.newVnodesCache=new Map,l}return o(i,[{key:"handleFetchSuccess",value:function(e){null!=e&&this.newItemsTracker.clear(),r(a(i.prototype),"handleFetchSuccess",this).call(this,e)}},{key:"handleItemsUpdated",value:function(e){e.keys.forEach(function(e){this.vnodesCache.delete(e)}.bind(this)),r(a(i.prototype),"handleItemsUpdated",this).call(this,e)}},{key:"handleItemsRemoved",value:function(e){e.keys.forEach(function(e){this.vnodesCache.delete(e)}.bind(this)),r(a(i.prototype),"handleItemsRemoved",this).call(this,e)}},{key:"handleModelRefresh",value:function(){this.vnodesCache.clear(),r(a(i.prototype),"handleModelRefresh",this).call(this)}},{key:"addItem",value:function(e,t,n,o){var r=this.isInitialFetch();null==this.callback.getCurrentItem()&&r&&0==t&&this.callback.setCurrentItem(e.key);var s=this.renderItem(e,t,n);return this.decorateItem(s,e,t,r,o),s}},{key:"renderItem",value:function(e,t,n){var o,r,s,i=e.key,l=this.vnodesCache.get(i);if(l)return this.newVnodesCache.set(i,{vnodes:l.vnodes}),l.vnodes;e.isLeaf||(o=this.callback.getGroupRenderer()),null==o&&(o=this.callback.getItemRenderer()),r=o({data:n,key:e.key,leaf:e.isLeaf,parentKey:e.parentKey,depth:e.treeDepth});for(var a=0;a<r.length;a++){if(1===r[a]._node.nodeType){s=r[a];break}}var u=[s];return this.newVnodesCache.set(i,{vnodes:u}),u}},{key:"decorateItem",value:function(e,t,n,o,r){var s=e[0],i=s._node;if(null!=i){s.key=t.key,i.key=t.key,i.setAttribute("key",JSON.stringify(t.key)),i.setAttribute("role","listitem"),i.setAttribute("tabIndex","-1"),this.getItemStyleClass(t,r,this.newItemsTracker.has(t.key),o).forEach(function(e){i.classList.add(e)});var l=this.getItemInlineStyle(t,r,n,o);if(Object.keys(l).forEach(function(e){i.style[e]=l[e]}),!t.isLeaf){var a=this.callback.getExpanded();a&&a.has(t.key)?i.setAttribute("aria-expanded","true"):i.setAttribute("aria-expanded","false")}}}},{key:"getItemInlineStyle",value:function(e,t,n,o){return{}}},{key:"getItemStyleClass",value:function(e,t,n,o){var r=[];return e.isLeaf?r.push("oj-stream-list-item"):r.push("oj-stream-list-group"),r}},{key:"renderSkeletonsForLoadMore",value:function(){return this.callback.renderSkeletons(3)}},{key:"renderSkeletonsForExpand",value:function(e){return this.callback.renderSkeletons(this.getLoadMoreCount(),!0,e)}}]),i}(),g=function(t,n,o,r){var s,i=arguments.length,l=i<3?n:null===r?r=Object.getOwnPropertyDescriptor(n,o):r;if("object"===("undefined"==typeof Reflect?"undefined":e(Reflect))&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,n,o,r);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(l=(i<3?s(l):i>3?s(n,o,l):s(n,o))||l);return i>3&&l&&Object.defineProperty(n,o,l),l};n.StreamList=v=function(e){s(r,i.VComponent);var n=l(r);function r(e){var o;return t(this,r),(o=n.call(this,e)).restoreFocus=!1,o.actionableMode=!1,o.skeletonHeight=0,o.setRootElement=function(e){o.root=e},o.state={renderedData:null,outOfRangeData:null,initialSkeleton:!0,initialSkeletonCount:1,expandedToggleKeys:new f.KeySetImpl,expandedSkeletonKeys:new f.KeySetImpl,expandingKeys:new f.KeySetImpl,height:0},o}return o(r,[{key:"_handleFocusIn",value:function(){this._clearFocusoutTimeout()}},{key:"_handleFocusOut",value:function(){this._clearFocusoutTimeout(),this.actionableMode?this._focusoutTimeout=setTimeout(function(){this._doBlur()}.bind(this),100):this._isFocusBlurTriggeredByDescendent(event)||this._doBlur()}},{key:"_clearFocusoutTimeout",value:function(){this._focusoutTimeout&&(clearTimeout(this._focusoutTimeout),this._focusoutTimeout=null)}},{key:"_handleClick",value:function(e){var t=e.target.closest("."+this.getGroupStyleClass());if(t){var n=t.key,o=this.props.expanded.has(n);this._handleToggleExpanded(n,o)}this._handleTouchOrClickEvent(e)}},{key:"_handleToggleExpanded",value:function(e,t){this.updateState(function(n,o){var r=n.expandedToggleKeys;if(!r.has(e)){r=r.add([e]);var s=o.expanded;return r.values().forEach(function(e){s=t?s.delete([e]):s.add([e])}),this._updateProperty("expanded",s,!0),{expandedToggleKeys:r}}return{}}.bind(this))}},{key:"_handleKeyDown",value:function(e){if(this.currentItem){var t;switch(e.keyCode){case 37:case 39:if(this.currentItem.classList.contains(this.getGroupStyleClass())){var n=this.currentItem.key,o=this.props.expanded.has(n);(39===e.keyCode&&!o||37===e.keyCode&&o)&&this._handleToggleExpanded(n,o)}break;case 38:if(!1===this.actionableMode)for(t=this.currentItem.previousElementSibling;t&&t.previousElementSibling&&t.classList.contains("oj-stream-list-skeleton");)t=t.previousElementSibling;break;case 40:if(!1===this.actionableMode)for(t=this.currentItem.nextElementSibling;t&&t.nextElementSibling&&t.classList.contains("oj-stream-list-skeleton");)t=t.nextElementSibling;break;case 113:!1===this.actionableMode&&this._enterActionableMode();break;case 27:!0===this.actionableMode&&this._exitActionableMode(!0);break;case 9:!0===this.actionableMode&&this.currentItem&&(e.shiftKey?u.handleActionablePrevTab(e,this.currentItem)&&e.preventDefault():u.handleActionableTab(e,this.currentItem)&&e.preventDefault())}null!=t&&(t.classList.contains(this.getItemStyleClass())||t.classList.contains(this.getGroupStyleClass()))&&(this._updateCurrentItemAndFocus(t,!0),e.preventDefault())}}},{key:"_touchStartHandler",value:function(e){this._handleTouchOrClickEvent(e)}},{key:"render",value:function(){var e,t=this.state.initialSkeleton,n=this.state.initialSkeletonCount;if(null==this.contentHandler&&t)e=this._renderInitialSkeletons(n);else{var o=this.getData();null!=o&&t||null==o?e=this._renderInitialSkeletons(n,null==o):null!=o&&(e=this.contentHandler.render(),this.currentItem&&this.currentItem.contains(document.activeElement)&&(this.restoreFocus=!0))}return i.h("oj-stream-list",{ref:this.setRootElement},i.h("div",{role:"list","data-oj-context":!0,onClick:this._handleClick,onKeydown:this._handleKeyDown,onTouchstart:this._touchStartHandler,onFocusin:this._handleFocusIn,onFocusout:this._handleFocusOut},e))}},{key:"_doBlur",value:function(){this.actionableMode&&this._exitActionableMode(!1),this.currentItem&&this.currentItem.classList.remove("oj-focus")}},{key:"_isFocusBlurTriggeredByDescendent",value:function(e){return void 0===e.relatedTarget||!(null==e.relatedTarget||!this.root.contains(e.relatedTarget))}},{key:"_renderInitialSkeletons",value:function(e,t){if(t){var n=this._getScroller();null!=n&&(n.scrollTop=0)}return this.renderSkeletons(e)}},{key:"renderSkeletons",value:function(e,t,n){for(var o,r=[],s=this._isTreeData(),i=0;i<e;i++){var l=t;!t&&s&&i%4&&(l=!0),n&&(o=n+"_"+i),r.push(this._renderSkeleton(l,o))}return r}},{key:"_renderSkeleton",value:function(e,t){var n="oj-stream-list-skeleton";return e&&(n+=" oj-stream-list-child-skeleton"),i.h("div",{class:n,key:t},i.h("div",{class:"oj-stream-list-skeleton-content oj-animation-skeleton"}))}},{key:"_applySkeletonExitAnimation",value:function(e){return new Promise(function(t,n){var o=[];e.forEach(function(e){o.push(y.fadeOut(e))}),Promise.all(o).then(function(){t(!0)})})}},{key:"_isTreeData",value:function(){var e=this.props.data;return null!=e&&this.instanceOfTreeDataProvider(e)}},{key:"instanceOfTreeDataProvider",value:function(e){return"getChildDataProvider"in e}},{key:"_postRender",value:function(){this._registerScrollHandler();var e=this.getData(),t=this.state.initialSkeleton;if(null!=e&&t){var n=this.getRootElement().querySelectorAll(".oj-stream-list-skeleton");this._applySkeletonExitAnimation(n).then(function(){this.updateState({initialSkeleton:!1})}.bind(this))}else null!=e&&this.contentHandler.postRender();this.actionableMode=!1;var o=this.root.querySelectorAll(".oj-stream-list-item, .oj-stream-list-group");this._disableAllTabbableElements(o),this._restoreCurrentItem(o)}},{key:"mounted",value:function(){var e=this,t=this.props.data,n=this.props.scrollPolicyOptions.scroller?this.props.scrollPolicyOptions.scroller:this.root;this._isTreeData()?this.contentHandler=new k(n,t,this,this.props.scrollPolicyOptions):null!=t&&(this.contentHandler=new m(n,t,this,this.props.scrollPolicyOptions)),this.contentHandler.fetchRows();var o=this.root.clientHeight;this.updateState({height:o});var r=this.root.querySelector(".oj-stream-list-skeleton");if(r&&(this.skeletonHeight=this.outerHeight(r),this.updateState({initialSkeletonCount:Math.max(1,Math.floor(o/this.skeletonHeight))})),window.ResizeObserver){var s=this.root,i=new window.ResizeObserver(function(t){t.forEach(function(t){if(t.target===s&&t.contentRect){var n=e.state.height,o=Math.round(t.contentRect.height);Math.abs(o-n)>1&&e.updateState({height:o})}})});i.observe(s),this.resizeObserver=i}this._postRender()}},{key:"getSkeletonHeight",value:function(){return this.skeletonHeight}},{key:"outerHeight",value:function(e){var t=e.offsetHeight,n=getComputedStyle(e);return t+=parseInt(n.marginTop)+parseInt(n.marginBottom)}},{key:"unmounted",value:function(){this.contentHandler&&this.contentHandler.destroy(),this.contentHandler=null,this.resizeObserver&&this.resizeObserver.disconnect(),this.resizeObserver=null,this.scrollListener&&null!=this._getScroller()&&this._getScroller().removeEventListener("scroll",this.scrollListener)}},{key:"getRootElement",value:function(){return this.root}},{key:"updated",value:function(e,t){var n=t.expandingKeys;if(this.state.expandingKeys.values().forEach(function(e){n.has(e)||this.contentHandler.expand(e)}.bind(this)),this.props.data!=e.data){this.contentHandler&&this.contentHandler.destroy(),this.setCurrentItem(null),this.updateState({renderedData:null,outOfRangeData:null,initialSkeleton:!0,initialSkeletonCount:this.state.initialSkeletonCount,expandedToggleKeys:new f.KeySetImpl,expandedSkeletonKeys:new f.KeySetImpl,expandingKeys:new f.KeySetImpl});var o=this.props.scrollPolicyOptions.scroller?this.props.scrollPolicyOptions.scroller:this.root;this._isTreeData()?this.contentHandler=new k(o,this.props.data,this,this.props.scrollPolicyOptions):null!=this.props.data&&(this.contentHandler=new m(o,this.props.data,this,this.props.scrollPolicyOptions)),this.contentHandler.fetchRows()}this._postRender(),this.props.scrollPosition!=e.scrollPosition&&this._syncScrollTopWithProps()}},{key:"_unregisterScrollHandler",value:function(){this._getScrollEventElement().removeEventListener("scroll",this.scrollListener)}},{key:"_registerScrollHandler",value:function(){var e=this._getScrollEventElement();this._unregisterScrollHandler(),e.addEventListener("scroll",this.scrollListener)}},{key:"scrollListener",value:function(){var e=this;this._ticking||(window.requestAnimationFrame(function(){e._updateScrollPosition(),e._ticking=!1}),this._ticking=!0)}},{key:"_updateScrollPosition",value:function(){var e={},t=this._getScroller().scrollTop,n=this._findClosestElementToTop(t);if(e.y=t,null!=n){var o=n.elem;e.offsetY=n.offsetY,e.key=o.getAttribute("key"),this._isTreeData()&&o.classList.contains("oj-stream-list-item")?e.parentKey=this._getParentKey(o):e.parentKey=null}this._updateProperty("scrollPosition",e)}},{key:"_syncScrollTopWithProps",value:function(){var e,t=this.props.scrollPosition,n=t.key;if(n){var o=t.parentKey,r=this._getItemByKey(n,o);if(null==r)return;var s=this.root;e=r.offsetTop-s.offsetTop;var i=t.offsetY;isNaN(i)||(e+=i)}else{var l=t.y;if(isNaN(l))return;e=l}e>this._getScroller().scrollHeight||(this._getScroller().scrollTop=e)}},{key:"_getParentKey",value:function(e){for(;e;){if(e.classList.contains("oj-stream-list-group"))return e.key;e=e.previousElementSibling}return null}},{key:"_getItemByKey",value:function(e,t){for(var n=this.root.querySelectorAll(".oj-stream-list-item, .oj-stream-list-group"),o=0;o<n.length;o++){var r=n[o];if(r===e&&(null==t||this._getParentKey(r)===t))return r}}},{key:"_getScrollEventElement",value:function(){var e=this.props.scrollPolicyOptions.scroller;return null!=e?e===document.body||e===document.documentElement?window:e:this.getRootElement()}},{key:"_getScroller",value:function(){var e=this.props.scrollPolicyOptions.scroller;return null!=e?e:this.getRootElement()}},{key:"_findClosestElementToTop",value:function(e){var t=this.root.querySelectorAll(".oj-stream-list-item, .oj-stream-list-group");if(null==t||0===t.length)return null;for(var n=this.root.offsetTop,o=Math.max(e,0),r=0-n,s=o,i=0,l=t[i],a=!1,u={elem:l,offsetY:s};!a&&i>=0&&i<t.length&&(r=(l=t[i]).offsetTop-n,!(a=(s=Math.abs(o-r))<1||o<=r));)u={elem:l,offsetY:s},i+=1;return u}},{key:"_getExpandSkeletonsForKey",value:function(e){var t=[];return this.getRootElement().querySelectorAll(".oj-stream-list-child-skeleton").forEach(function(n){n.getAttribute("key")==e&&t.push(n)}),t}},{key:"isAvailable",value:function(){return null!=this.contentHandler}},{key:"getCurrentItem",value:function(){return this.currentKey}},{key:"setCurrentItem",value:function(e){this.currentKey=e}},{key:"getData",value:function(){return this.state.renderedData}},{key:"setData",value:function(e){this.updateState({renderedData:e})}},{key:"updateData",value:function(e){this.updateState(function(t){return e(t.renderedData,t.expandingKeys)}.bind(this))}},{key:"getExpanded",value:function(){return this.props.expanded}},{key:"setExpanded",value:function(e){this._updateProperty("expanded",e)}},{key:"updateExpand",value:function(e){this.updateState(function(t,n){return e(t.renderedData,t.expandedSkeletonKeys,t.expandingKeys,n.expanded)}.bind(this))}},{key:"getExpandingKeys",value:function(){return this.state.expandingKeys}},{key:"setExpandingKeys",value:function(e){this.updateState({expandingKeys:e})}},{key:"updateExpandingKeys",value:function(e){this.updateState(function(t){return{expandingKeys:t.expandingKeys.add([e])}})}},{key:"getSkeletonKeys",value:function(){return this.state.expandedSkeletonKeys}},{key:"setSkeletonKeys",value:function(e){this.updateState({expandedSkeletonKeys:e})}},{key:"updateSkeletonKeys",value:function(e){this.updateState(function(t){return{expandedSkeletonKeys:t.expandedSkeletonKeys.add([e])}})}},{key:"getOutOfRangeData",value:function(){return this.state.outOfRangeData}},{key:"setOutOfRangeData",value:function(e){this.updateState({outOfRangeData:e})}},{key:"getItemRenderer",value:function(){return this.props.itemTemplate}},{key:"getItemStyleClass",value:function(){return"oj-stream-list-item"}},{key:"getGroupRenderer",value:function(){return this.props.groupTemplate}},{key:"getGroupStyleClass",value:function(){return"oj-stream-list-group"}},{key:"_handleTouchOrClickEvent",value:function(e){var t=e.target,n=t.closest(".oj-stream-list-item, .oj-stream-list-group");n&&(this._isInputElement(t)||this._isInsideInputElement(t,n)?(this._updateCurrentItemAndFocus(n,!1),this._enterActionableMode(t)):this._updateCurrentItemAndFocus(n,!0))}},{key:"_isInputElement",value:function(e){return null!=e.nodeName.match(/^INPUT|SELECT|OPTION|TEXTAREA/)&&!e.readOnly}},{key:"_isInsideInputElement",value:function(e,t){for(var n=!1;e!==t&&null!=e;){if(e.classList.contains("oj-form-control")){e.readonly||e.disabled||(n=!0);break}e=e.parentNode}return n}},{key:"_resetFocus",value:function(e){this.actionableMode&&this._exitActionableMode(!1),e.classList.remove("oj-focus"),e.tabIndex=-1}},{key:"_setFocus",value:function(e,t){e.tabIndex=0,t&&(e.classList.add("oj-focus"),e.focus())}},{key:"_updateCurrentItemAndFocus",value:function(e,t){var n=this.currentItem,o=e;this._resetFocus(n),this._setFocus(o,t),this.currentItem=o,this.setCurrentItem(o.key)}},{key:"_isInViewport",value:function(e){var t=e.offsetTop,n=this._getScroller().scrollTop;return t>=n&&t<=n+this.state.height}},{key:"_restoreCurrentItem",value:function(e){if(null!=this.currentKey)for(var t=0;t<e.length;t++)if(h.KeyUtils.equals(e[t].key,this.currentKey)){var n=e[t];if(this.restoreFocus&&this._isInViewport(n))return void this._updateCurrentItemAndFocus(n,!0);this._setFocus(n,!1),this.currentItem=n;break}this.restoreFocus=!1}},{key:"_disableAllTabbableElements",value:function(e){e.forEach(function(e){c.getContext(e).getBusyContext().whenReady().then(function(){u.disableAllFocusableElements(e,!0)})})}},{key:"_enterActionableMode",value:function(e){if(this.actionableMode=!0,this.currentItem){var t=u.enableAllFocusableElements(this.currentItem,!0);null==e&&t&&t.length>0&&t[0].focus()}}},{key:"_exitActionableMode",value:function(e){this.actionableMode=!1,this.currentItem&&(u.disableAllFocusableElements(this.currentItem,!0),this._setFocus(this.currentItem,e))}}],[{key:"initStateFromProps",value:function(e,t){return v.updateStateFromProps(e,t,null)}},{key:"updateStateFromProps",value:function(e,t,n){var o=t.expandedToggleKeys,r=t.expandingKeys,s=t.renderedData,i=t.expandedSkeletonKeys,l=e.expanded;if(n&&l!==n.expanded){var a=n.expanded;o.values().forEach(function(e){a.has(e)!==l.has(e)&&(o=o.delete([e]))});var u=[];return s.value.metadata.forEach(function(e){var t=e.key,n=e.expanded,o=l.has(t);n&&!o?(u.push(t),e.expanded=!1):!n&&o&&(r=r.add([t]),e.expanded=!0)}),u.forEach(function(e){s=v.collapse(e,s),r=r.delete([e]),i=i.delete([e])}),{renderedData:s,expandingKeys:r,expandedToggleKeys:o,expandedSkeletonKeys:i}}}},{key:"_findIndex",value:function(e,t){for(var n=0;n<e.length;n++)if(h.KeyUtils.equals(t,e[n].key))return n;return-1}}]),r}(),n.StreamList.collapse=function(e,t){var n=t.value.data,o=t.value.metadata,r=v._findIndex(o,e);if(r>-1){var s=v._getLocalDescendentCount(o,r);n.splice(r+1,s),o.splice(r+1,s)}return{value:{data:n,metadata:o},done:t.done}},n.StreamList._getLocalDescendentCount=function(e,t){for(var n=0,o=e[t].treeDepth,r=e.length,s=t+1;s<r;s++){if(!(e[s].treeDepth>o))return n;n+=1}return n},n.StreamList.metadata={extension:{_DEFAULTS:function e(){t(this,e),this.data=null,this.expanded=new f.KeySetImpl,this.scrollPolicy="loadMoreOnScroll",this.scrollPolicyOptions={fetchSize:25,maxCount:500,scroller:null},this.scrollPosition={y:0}}},properties:{data:{type:"object|null",value:null},expanded:{type:"object",writeback:!0,readOnly:!1},scrollPolicy:{type:"string",enumValues:["loadAll","loadMoreOnScroll"],value:"loadMoreOnScroll"},scrollPolicyOptions:{type:"object",properties:{fetchSize:{type:"number",value:25},maxCount:{type:"number",value:500},scroller:{type:"Element|null",value:null}}},scrollPosition:{type:"object",properties:{y:{type:"number",value:0},key:{type:"any"},offsetY:{type:"number"},parentKey:{type:"any"}},writeback:!0,readOnly:!1}},slots:{groupTemplate:{},itemTemplate:{}}},g([i.listener()],n.StreamList.prototype,"_handleFocusIn",null),g([i.listener()],n.StreamList.prototype,"_handleFocusOut",null),g([i.listener()],n.StreamList.prototype,"_handleClick",null),g([i.listener()],n.StreamList.prototype,"_handleKeyDown",null),g([i.listener({passive:!0})],n.StreamList.prototype,"_touchStartHandler",null),g([i.listener()],n.StreamList.prototype,"scrollListener",null),n.StreamList=v=g([i.customElement("oj-stream-list")],n.StreamList),Object.defineProperty(n,"__esModule",{value:!0})})}();