define(["exports","ojs/ojcore-base","ojs/ojcontext","ojs/ojdefaultsutils","ojs/ojcustomelement"],function(t,e,n,o,r){"use strict";
/**
     * @license
     * Copyright (c) 2014, 2020, Oracle and/or its affiliates.
     * The Universal Permissive License (UPL), Version 1.0
     * as shown at https://oss.oracle.com/licenses/upl/
     * @ignore
     */
/**
     * @license
     * Copyright (c) 2014, 2020, Oracle and/or its affiliates.
     * The Universal Permissive License (UPL), Version 1.0
     * as shown at https://oss.oracle.com/licenses/upl/
     * @ignore
     */const i=Object.freeze({});function s(t){return t?"string"==typeof t?t.split(" ").reduce((t,e)=>(e&&(t[e]=!0),t),{}):t:i}var l;!function(t){t.LISTENER_OPTIONS_SYMBOL=Symbol();const n=new Set(["key","ref","children"]),r=Array.isArray,l=function(t){return t&&(null!=t.type||null!=t._text||t._node)},u=function(t){return(null==t?void 0:t.mount)&&(null==t?void 0:t.patch)&&(null==t?void 0:t.notifyUnmounted)&&(null==t?void 0:t.notifyMounted)};function c(t,e){for(let n=0;n<t.length;n++){const o=t[n];if(r(o))return a(t,n,t.slice(0,n),e);l(o)?e&&!o.isSVG&&(o.isSVG=!0):t[n]={_text:null==o?"":o}}return t}function a(t,e,n,o){for(let i=e;i<t.length;i++){const e=t[i];r(e)?a(e,0,n,o):l(e)?(o&&!e.isSVG&&(e.isSVG=!0),n.push(e)):null==e||"string"==typeof e?n.push({_text:null==e?"":e}):n.push(e)}return n}t.h=function(t,n,...o){let s,a,_=!1,d=!1;if("string"!=typeof t)a=(d="function"==typeof t&&u(t.prototype))&&t.prototype.mountContent,s=o;else{a=!(_="svg"===t)&&e.ElementUtils.isValidCustomElementName(t);const n=o.length;if(1===n){const t=o[0];r(t)?s=c(t,_):l(t)?(t.isSVG=_,s=[t]):s=[{_text:null==t?"":t}]}else s=n>1?c(o,_):o}const p=d||a;return{type:t,isSVG:_,isComponent:d,isCustomElement:a,key:null==n?void 0:n.key,props:n||(p?Object.create(null):i),content:s,ref:null==n?void 0:n.ref}};const _="http://www.w3.org/2000/svg",d="http://www.w3.org/1999/xlink",p={show:d,actuate:d,href:d};function h(t,e,n,o){if(n!==o)return!0;for(let n in t)if(t[n]!==e[n])return!0;return!1}function f(t,n=!1){let o;if(t._node)return t._node;if(null!=t._text)o=document.createTextNode(t._text);else{const r=t.type,i=t.props,s=t.content,l=t.isSVG;if("string"==typeof r)S(o=l?document.createElementNS(_,r):document.createElement(r),i,null,n||t.isCustomElement),E(o)?C(o,s):v(o,s);else if("function"==typeof r)if(t.isComponent){let n;const l=r,u=b(l,i,t.isCustomElement);t._uncontrolled=u.uncontrolled,(n=new l(u.controlled))._uniqueId=e.__AttributeUtils.getUniqueId(i.id),o=n.mount(u.controlled,s,u.uncontrolled),t._data=n}else{const e=r(i,s);o=f(e),t._data=e}}if(null==o)throw new Error("Unknown node type!");return t._node=o,o}function m(t){let e;if(null!=t._text)e=document.createTextNode(t._text);else{const o=t.type,r=t.props,i=t.content,s=t.isSVG;"string"==typeof o&&(function(t,e,o,r){if(e){const o=Object.keys(e);o.forEach(function(o){if(n.has(o))return;const r=e[o];t.setAttribute(o,r)})}}(e=s?document.createElementNS(_,o):document.createElement(o),r,0,t.isCustomElement),C(e,i))}if(null==e)throw new Error("content inside <template> elements is limited to HTML elements and text");return t._node=e,e}function E(t){return"TEMPLATE"===t.nodeName}function P(t){if(t.isComponent){const e=t._data;x(t.ref,e),x(e._vnode.props.ref,t._node),t.isCustomElement||e.notifyMounted()}else"function"!=typeof t.type&&x(t.ref,t._node)}function v(t,n,o=0,r=n.length-1,i=null){for(;o<=r;){const r=n[o++];if(r._node){const n=r._node;G(t,r,i),1===n.nodeType&&e.Components&&e.Components.subtreeShown(n)}else G(t,r,i)}}function C(t,e,n=0,o=e.length-1,r=null){for(;n<=o;){const o=e[n++];m(o),G(t,o,r)}}function y(t,e,n=0,o=e.length-1){let r=void 0;for(t.childNodes.length===o-n+1&&(t.textContent="",r=!0);n<=o;){let o=e[n++];r||F(t,o)}}function g(t){if(r(t))for(let e=0;e<t.length;e++)g(t[e]);else{if(t.isComponent){t._data.notifyUnmounted(t._node)}else null!=t.content&&g(t.content);(t.isComponent||"function"!=typeof t.type)&&x(t.ref,null)}}function O(t,e){var n,o;const r=t.metadata;return null!=(null===(o=null===(n=null==r?void 0:r.extension)||void 0===n?void 0:n._ROOT_PROPS_MAP)||void 0===o?void 0:o[e])}function b(t,n,r){const i=o.DefaultsUtils.getStaticDefaults(t,t.metadata,!0),s={controlled:Object.create(i),uncontrolled:{}};for(let o in n){const i=n[o];void 0!==i&&(r&&e.__AttributeUtils.isGlobalOrData(o)&&!O(t,o)?s.uncontrolled[o]=i:s.controlled[o]=i)}return s}function S(t,e,o,r){e&&function(t,e,o,r){Object.keys(e).forEach(function(s){if(n.has(s))return;const l=e[s],u=o[s];l!==u&&("style"===s?R(t.style,l||i,u||i,""):"class"===s?T(t,l,u,r):A(t,s,l,u)||N(t,s,l,r)||(t[s]=l))})}(t,e,o||i,r),o&&function(t,e,n,o){Object.keys(n).forEach(function(r){if("key"===r||"ref"===r)return;const s=n[r];r in e||("style"===r?R(t.style,i,s||i,""):"class"===r?T(t,null,s,o):A(t,r,null,s)||N(t,r,null,o)||(t[r]=void 0))})}(t,e||i,o,r)}function R(t,e,n,o){for(let o in e){const r=n[o],i=e[o];r!==i&&(t[o]=i)}for(let r in n)r in e||(t[r]=o)}function T(t,e,n,o){o?function(t,e,n){const o=s(n),r=s(e);for(let e in o)o[e]&&!r[e]&&t.classList.remove(e);for(let e in r)r[e]&&!o[e]&&t.classList.add(e)}(t,e,n):function(t,e){if(e){const n="object"==typeof e?Object.keys(e).filter(t=>e[t]).join(" "):e;t.setAttribute("class",n)}else t.removeAttribute("class")}(t,e)}function A(e,n,o,r){if(o||r){const i=function(t){if(/^on[A-Z]/.test(t))return t.substr(2,1).toLowerCase()+t.substr(3);return null}(n);if(i)return function(e,n,o,r){r&&e.removeEventListener(n,r,r[t.LISTENER_OPTIONS_SYMBOL]);o&&e.addEventListener(n,o,o[t.LISTENER_OPTIONS_SYMBOL])}(e,i,o,r),!0}return!1}function N(t,n,o,r){if(r&&e.__AttributeUtils.isGlobalOrData(n)||!r&&"value"!==n&&"checked"!==n){const r=e.__AttributeUtils.getNativeAttr(n);if(!0===o)t.setAttribute(r,"");else if(!1===o)t.removeAttribute(r);else if(null!=o){const e=p[r];void 0!==e?t.setAttributeNS(e,r,o):t.setAttribute(r,o)}else t.removeAttribute(r);return!0}return!1}function U(t,e,n,o=!1){let r,i,s=e._node;if(e===t)return s;if(E(s))return t._node=s,s;if(t._node)return s!==t._node&&V(n,t,e),t._node;if(null!=(r=e._text)&&null!=(i=t._text))r!==i&&(s.nodeValue=i);else if(e.type===t.type&&e.isSVG===t.isSVG){const r=e.type;if("function"==typeof r)if(e.isComponent){const n=e._data,o=b(r,t.props,t.isCustomElement);t._uncontrolled=o.uncontrolled,n.patch(o.controlled,t.content,o.uncontrolled,e._uncontrolled),t._data=n,x(t.ref,n,e.ref)}else{if((r.shouldUpdate||h)(t.props,e.props,t.content,e.content)){const o=r(t.props,t.content);s=U(o,e._data,n),t._data=o}else t._data=e._data}else{if("string"!=typeof r)throw new Error(`Error while patching. Unknown node type '${r}'.`);e.isCustomElement&&function(t,e){if(t===e)return!1;if(t.length!==e.length)return!0;return t.some(function(t,n){var o,r;const i=e[n];return t.type!==i.type||(null===(o=t.props)||void 0===o?void 0:o.slot)!==(null===(r=i.props)||void 0===r?void 0:r.slot)})}(t.content,e.content)?s=V(n,t,e):(S(s,t.props,e.props,o||e.isCustomElement),B(s,t.content,e.content),x(t.ref,s,e.ref))}}else n&&(s=V(n,t,e));return t._node=s,s}function k(t,e){return null==t.key&&null==e.key||t.key===e.key}function B(t,e,n,o=0,r=e.length-1,i=0,s=n.length-1){if(e===n)return;let l,u=function(t,e,n,o,r,i,s,l){let u,c,a=0;for(;n<=o&&r<=i&&s(u=t[n],c=e[r]);)l&&U(u,c,l),n++,r++,a++;return a}(e,n,o,r,i,s,k,t);if(s-=u=function(t,e,n,o,r,i,s,l){let u,c,a=0;for(;n<=o&&r<=i&&s(u=t[o],c=e[i]);)l&&U(u,c,l),o--,i--,a++;return a}(e,n,o+=u,r,i+=u,s,k,t),o>(r-=u)&&i>s)return;if(o<=r&&i>s)return void v(t,e,o,r,l=n[i]);if(i<=s&&o>r)return void y(t,n,i,s);const c=s-i+1,a=r-o+1;if(u=-1,c<a){if((u=M(e,n,o,r,i,s,k))>=0){v(t,e,o,u-1,l=n[i]);const a=u+c;for(o=u;o<a;)U(e[o++],n[i++],t);return void v(t,e,o,r,n[s+1])}}else if(c>a&&(u=M(n,e,i,s,o,r,k))>=0){y(t,n,i,u-1);const r=u+a;for(i=u;i<r;)U(e[o++],n[i++],t);return void y(t,n,i,s)}return i===s?(F(t,n[i]),void v(t,e,o,r,n[i+1])):o===r?(y(t,n,i,s),void G(t,e[o],n[s+1])):void(function(t,e,n,o=0,r=e.length-1,i=0,s=n.length-1){const l=r-o+1,u=s-i+1,c=l+u,a=[];let _,d,p,h,f,m,E;t:for(_=0;_<=c;_++){if(_>50)return!0;for(E=_-1,f=_?a[_-1]:[0,0],m=a[_]=[],d=-_;d<=_;d+=2){for(h=d===-_||d!==_&&f[E+d-1]<f[E+d+1]?f[E+d+1]:f[E+d-1]+1,p=h-d;h<u&&p<l&&k(n[i+h],e[o+p]);)h++,p++;if(h===u&&p===l)break t;m[_+d]=h}}const P=Array(_/2+c/2),v={};let C,y=P.length-1;for(_=a.length-1;_>=0;_--){for(;h>0&&p>0&&k(n[i+h-1],e[o+p-1]);)P[y--]=L,h--,p--;if(!_)break;E=_-1,f=_?a[_-1]:[0,0],(d=h-p)===-_||d!==_&&f[E+d-1]<f[E+d+1]?(p--,P[y--]=D):(h--,P[y--]=I,null!=(C=n[i+h]).key&&(v[C.key]=i+h))}j(t,P,e,n,o,i,v)}(t,e,n,o,r,i,s)&&function(t,e,n,o,r,i,s){const l=r-o+1,u=s-i+1,c=Math.min(l,u),a=Array(c+1);a[0]=-1;for(let t=1;t<a.length;t++)a[t]=s+1;const _=Array(c),d={},p=[];for(let t=i;t<=s;t++){let e=n[t],o=e.key;null!=o?d[o]=t:p.push(t)}let h=0;for(let t=o;t<=r;t++){const n=e[t],o=null==n.key?p[h++]:d[n.key];if(null!=o){let e=w(a,o);e>=0&&(a[e]=o,_[e]={newi:t,oldi:o,prev:_[e-1]})}}let f=a.length-1;for(;a[f]>s;)f--;let m=_[f];const E=Array(u+l-f);let P=r,v=s,C=E.length-1;for(;m;){let t=m,e=t.newi,n=t.oldi;for(;P>e;)E[C--]=D,P--;for(;v>n;)E[C--]=I,v--;E[C--]=L,P--,v--,m=m.prev}for(;P>=o;)E[C--]=D,P--;for(;v>=i;)E[C--]=I,v--;j(t,E,e,n,o,i,d)}(t,e,n,o,r,i,s))}t.mountCustomElement=function(t,e){const n=t.type,o=t.props,r=t.content,i=document.createElement(n);return S(i,e,null,!0),S(i,o,null,!0),v(i,r),t._node=i,i},t.mountCustomElementContent=function(t,e){const n=t._node;S(n,t.props,e,!0),v(n,t.content),x(t.ref,n)},t.mount=f,t.mounted=function t(e){if(r(e))for(let n=0;n<e.length;n++)t(e[n]);else e.isComponent?e._data.notifyMounted():null!=e.content&&t(e.content)},t.unmount=g,t.patchCustomElement=function(t,e,n,o){const r=e._node;e!==t&&(S(r,n,o,!0),S(r,t.props,e.props,!0),B(r,t.content,e.content),x(t.ref,r,e.ref))},t.patchCustomElementContent=function(t,n,o){const r=n._node;if(n===t)return;const i={},s=n.props;for(let t in s)t=t,(null!==e.__AttributeUtils.eventListenerPropertyToEventType(t)||"class"===t||"style"===t)&&(i[t]=s[t]);var l;Object.assign(i,o),S(r,t.props,i,!0),B(r,t.content,n.content),x(t.ref,r,n.ref)},t.patch=U;const L=2,D=4,I=8;function j(t,e,n,o,r,i,s){const l={};for(let n=0,r=i;n<e.length;n++){const i=e[n];if(i===L)r++;else if(i===I){const e=o[r++];null!=e.key&&null!=l[e.key]||F(t,e)}}for(let u=0,c=r,a=i;u<e.length;u++){const r=e[u];if(r===L)U(n[c++],o[a++],t);else if(r===D){const e=n[c++];let r=null;null!=e.key&&(r=s[e.key]),null!=r&&(U(e,o[r],t),l[e.key]=r),G(t,e,a<o.length?o[a]:null)}else r===I&&a++}}function w(t,e){let n=1,o=t.length-1;for(;n<=o;){let r=Math.ceil((n+o)/2);e<t[r]?o=r-1:n=r+1}return n}function M(t,e,n,o,r,i,s){let l=r,u=-1;const c=i-r+1;for(;n<=o&&o-n+1>=c;){if(s(t[n],e[l])){if(u<0&&(u=n),++l>i)return u}else u=-1,l=r;n++}return-1}function V(t,e,n){n._clean&&n._clean();const o=null==e._node;o&&f(e);const r=e._node;return q(t).replaceChild(r,n._node),g(n),n._node=r,o&&P(e),r}function F(t,e){e._clean&&e._clean(),q(t).removeChild(e._node),g(e)}function G(t,e,n){const o=null==e._node;o&&f(e);const r=e._node;q(t).insertBefore(r,(null==n?void 0:n._node)||null),o&&P(e)}function x(t,e,n=null){n!==t&&("function"==typeof n&&n(null),"function"==typeof t&&t(e))}function q(t){if(E(t)){const e=t.content;if(e)return e}return t}}(l||(l={}));const u=l.h,c={};
/**
     * @license
     * Copyright (c) 2014, 2020, Oracle and/or its affiliates.
     * The Universal Permissive License (UPL), Version 1.0
     * as shown at https://oss.oracle.com/licenses/upl/
     * @ignore
     */var a;function _(t,e){switch(t.nodeType){case Node.COMMENT_NODE:return{_node:t};case Node.TEXT_NODE:return{_text:t.nodeValue,_node:t};case Node.ELEMENT_NODE:var n=[];t.childNodes.forEach(function(t){var e=_(t);e&&n.push(e)});var o={type:t.tagName.toLowerCase(),_node:t,props:t,content:n};return null!=e&&o.props.slot!==e&&(o.props.slot=e),o;default:return null}}function d(t,e){return function(n){if(n){var o=(r=e[0])&&r._node;if("TEMPLATE"===o.nodeName){if(!a)throw new Error("Unexpected call to render a template slot");return a.execute(t,o,n).map(t=>{const e=_(t);return e._clean=a.clean.bind(null,t),e})}}var r;return e}}c._DEFAULT_SLOT_PROP="children",c.proto=Object.create(e.BaseCustomElementBridge.proto),e.CollectionUtils.copyInto(c.proto,{AddComponentMethods:function(t){t.setProperty=function(t,n){var o=e.BaseCustomElementBridge.getInstance(this);o.SaveEarlyPropertySet(t,n)||o.SetProperty(this,t,n,this,!0)},t.getProperty=function(t){return e.BaseCustomElementBridge.getInstance(this).GetProperty(this,t,this)}},AttributeChangedCallback:function(t,n,o){if(e.BaseCustomElementBridge.proto.AttributeChangedCallback.call(this,t,n,o),n!==o){var r=e.BaseCustomElementBridge.getInstance(this);if(!r.ShouldHandleAttributeChanged(this)&&e.BaseCustomElementBridge.proto.ShouldHandleAttributeChanged.call(r,this)){var i=this._vcomp;i&&!i.isCustomElementFirst()||r.HandleAttributeChanged(this,t,n,o)}}},CreateComponent:function(t){if(!t._vcomp){e.Components&&e.Components.unmarkPendingSubtreeHidden(t);var n=e.BaseCustomElementBridge.__GetDescriptor(t.tagName),o=e.BaseCustomElementBridge.getSlotMap(t);this._initializeControlledProps(t);var r=this._getVComponentProps(),i=new n._CONSTRUCTOR(r);i._uniqueId=e.__AttributeUtils.getUniqueId(t.id),Object.defineProperty(t,"_vcomp",{value:i,enumerable:!1}),i.setCallbacks(this._getCallbacks(t)),this._mountCustomElement(t,t._vcomp,r,o)}t._vcomp.mounted(),this.__READY_TO_FIRE=!0,this.resolveDelayedReadyPromise()},DefineMethodCallback:function(t,n,o){t[n]=function(){this._vcomp||e.BaseCustomElementBridge.getInstance(this).throwError(this,"Cannot access methods before element is upgraded.");return this._vcomp[n].apply(this._vcomp,arguments)}},DefinePropertyCallback:function(t,n,o){function r(t,e){var r={isOuter:e,name:n,value:t,meta:o};this._BRIDGE._updateProperty(this._ELEMENT,r,!0)}function i(){var t=this._BRIDGE._PROPS[n];return void 0===t&&(t=this._BRIDGE._getDefaultValue(n,o),this._BRIDGE._PROPS[n]=t),t}o._derived||e.BaseCustomElementBridge.__DefineDynamicObjectProperty(t._propsProto,n,function(){return i.bind(this)()},function(t){r.bind(this)(t,!1)}),e.BaseCustomElementBridge.__DefineDynamicObjectProperty(t,n,function(){var t=this._vcomp;if(!t||t.isCustomElementFirst()){var n=e.BaseCustomElementBridge.getInstance(this);return i.bind(n._PROPS_PROXY)()}},function(t){var n=this._vcomp,o=e.BaseCustomElementBridge.getInstance(this);!n||n.isCustomElementFirst()?r.bind(o._PROPS_PROXY)(t,!0):n&&!n.isCustomElementFirst()&&o.throwError(this,"Cannot set properties on a VComponent-first element.")})},GetAttributes:function(t){var n=e.BaseCustomElementBridge.proto.GetAttributes.call(this,t),o=t.extension&&t.extension._ROOT_PROPS_MAP;return o&&Object.keys(o).forEach(function(t){n.push(e.__AttributeUtils.getGlobalAttrForProp(t))}),n},GetTrackChildrenOption:function(t){return t._vcomp?"none":"immediate"},ShouldHandleAttributeChanged:function(t){if(!e.BaseCustomElementBridge.proto.ShouldHandleAttributeChanged.call(this,t))return!1;var n=t._vcomp;return!n||n.isCustomElementFirst()&&!n.isPatching()},HandleAttributeChanged:function(t,n,o,r){var i=t._vcomp,s=this._EXTENSION._ROOT_PROPS_MAP;if(i&&s){var l=e.__AttributeUtils.getGlobalPropForAttr(n)||n;if(s[l]&&o!==r){if(null==r)delete this._LIVE_CONTROLLED_PROPS[l],i.isPatching()||delete this._VCOMP_CONTROLLED_PROPS[l];else{var u=t[l];this._LIVE_CONTROLLED_PROPS[l]=null!=u?u:r,i.isPatching()||(this._VCOMP_CONTROLLED_PROPS[l]=this._LIVE_CONTROLLED_PROPS[l])}i.isPatching()||this._queueRender(t)}}},HandleReattached:function(t){this._verifyConnectDisconnect(t,1)},HandleDetached:function(t){this._verifyConnectDisconnect(t,0)},_verifyConnectDisconnect:function(t,e){-1===this._verifyingState&&window.queueMicrotask(function(){this._verifyingState===e&&(0===this._verifyingState?t._vcomp.unmounted():t._vcomp.mounted()),this._verifyingState=-1}.bind(this)),this._verifyingState=e},InitializeElement:function(t){t._vcomp||(e.Components&&e.Components.markPendingSubtreeHidden(t),e.BaseCustomElementBridge.__InitProperties(t,t),this.InitializeEventCallbacks(t))},InitializePrototype:function(t){e.BaseCustomElementBridge.proto.InitializePrototype.call(this,t),Object.defineProperty(t,"_propsProto",{value:{}})},InitializeBridge:function(t,n){e.BaseCustomElementBridge.proto.InitializeBridge.call(this,t,n),this._verifyingState=-1,this._EXTENSION=this.METADATA.extension||{},this._CONSTRUCTOR=n._CONSTRUCTOR,this._PROPS={},this._PROP_CHANGE_QUEUE=[],this._PROP_CHANGE_EVENT_QUEUE=[],t._propsProto&&(this._PROPS_PROXY=Object.create(t._propsProto),this._PROPS_PROXY._BRIDGE=this,this._PROPS_PROXY._ELEMENT=t),this._LIVE_CONTROLLED_PROPS={},this._VCOMP_CONTROLLED_PROPS={}},InitializeEventCallbacks:function(t){const n=this.METADATA.events;n&&Object.keys(n).forEach(o=>{const r=n[o],i=e.__AttributeUtils.eventTypeToEventListenerProperty(o);this._PROPS[i]=(e=>{const n=Object.assign({},e),i=!!r.cancelable,s=[];i&&(n.accept=(t=>{s.push(t)}));const l={detail:n,bubbles:!!r.bubbles,cancelable:i},u=new CustomEvent(o,l);if(t.dispatchEvent(u),i)return u.defaultPrevented?Promise.reject():Promise.all(s).then(()=>Promise.resolve(),t=>Promise.reject(t))})})},PlaybackEarlyPropertySets:function(t){t._vcomp||e.BaseCustomElementBridge.proto.PlaybackEarlyPropertySets.call(this,t)},GetPreCreatePromise:function(t){var n=e.BaseCustomElementBridge.proto.GetPreCreatePromise.call(this,t);return!a&&function(t){for(var e=t.childNodes,n=0;n<e.length;n++){var o=e[n];if("template"===o.localName)return!0}return!1}(t)&&(n=n.then(function(){return new Promise(function(t,e){require(["ojs/ojtemplateengine"],function(e){a=e,t(e)},e)})})),n},ValidateAndSetProperty:function(t,e,n,o,r){var i=this.ValidatePropertySet(r,n,o);c.__SetProperty(t,e,n,i)},_mountCustomElement:function(t,e,n,o){this._content=c._processSlotContent(t,o);var r=Object.assign({},this._LIVE_CONTROLLED_PROPS);e.mountContent(n,this._content,t,r)},_queuePropertyUpdate:function(t,e,n,o){this._PROPS_PROXY[e]=n,o&&this._queueRender(t)},_updateProperty:function(t,e,n){this._PROP_CHANGE_QUEUE.push(e),n?this._processPropertyQueue(t):this._propsProcessingQueued||(this._propsProcessingQueued=!0,window.queueMicrotask(function(){this._processPropertyQueue(t),this._propsProcessingQueued=!1}.bind(this)))},_processPropertyQueue:function(t){for(var n=this._PROP_CHANGE_QUEUE.shift();n;){var o=n.name,r=n.value,i=n.meta;if(!this.SaveEarlyPropertySet(o,r)){var s=this._PROPS[o];e.BaseCustomElementBridge.__CompareOptionValues(o,i,r,s)||(n.isOuter&&(r=this.ValidatePropertySet(t,o,r)),void 0===r?delete this._PROPS[o]:this._PROPS[o]=r,n.previousValue=s,this._PROP_CHANGE_EVENT_QUEUE.push(n),t._vcomp&&n.isOuter&&this._queueRender(t))}n=this._PROP_CHANGE_QUEUE.shift()}this._firePropertyChangeEvents(t)},_firePropertyChangeEvents:function(t){for(var n=this._PROP_CHANGE_EVENT_QUEUE.shift();n;)e.BaseCustomElementBridge.__FirePropertyChangeEvent(t,n.name,n.value,n.previousValue,n.isOuter?"external":"internal"),n=this._PROP_CHANGE_EVENT_QUEUE.shift()},_queueRender:function(t){t._vcomp.queueRender(t,"propsUpdate")},_getVComponentProps:function(){var t=o.DefaultsUtils.getStaticDefaults(this._CONSTRUCTOR,this.METADATA,!0),e=Object.create(t);return Object.assign(e,this._PROPS,this._VCOMP_CONTROLLED_PROPS)},_getCallbacks:function(t){return{_updateProperty:this._queuePropertyUpdate.bind(this,t),getPropsForRender:()=>this._getVComponentProps(),patch:e=>{var n=Object.assign({},this._LIVE_CONTROLLED_PROPS);t._vcomp.patchContent(e,n,this._content),c._storeUnslottedNodes(t,this._slotVNodes)},convertChildrenToSlotProps:e=>{if(!this._slotProps){this._slotVNodes=e;var n=function(t,e,n){var o=e.slots||{},r=n._DYNAMIC_SLOT_PROP,i={};return t.forEach(function(t){var e=t.props?t.props.slot:"";let n=c._DEFAULT_SLOT_PROP;if(e&&(n=o[e]?e:r),n===r){if(!r)return;i[n]||(i[n]={[e]:[]}),i[n][e]||(i[n][e]=[]),i[n][e].push(t)}else n&&(i[n]||(i[n]=[]),i[n].push(t))}),i}(e,this.METADATA,this._EXTENSION);this._slotProps=function(t,e){var n={};return Object.keys(e).forEach(o=>{var r=e[o];o===c._DEFAULT_SLOT_PROP?n[o]=r:Array.isArray(r)?n[o]=d(t,r):(n[o]||(n[o]={}),Object.keys(r).forEach(e=>{n[o][e]=d(t,r[e])}))}),n}(t,n)}return this._slotProps}}},_initializeControlledProps:function(t){var n=this._EXTENSION._ROOT_PROPS_MAP;if(n){var o=this._LIVE_CONTROLLED_PROPS,r=this._VCOMP_CONTROLLED_PROPS;Object.keys(n).forEach(function(n){var i=e.__AttributeUtils.getGlobalAttrForProp(n);if(t.hasAttribute(i)){var s=t[n];o[n]=null!=s?s:t.getAttribute(i),r[n]=o[n]}})}},_getDefaultValue:function(t){return o.DefaultsUtils.getFrozenDefault(t,this._CONSTRUCTOR,this.METADATA)}}),c.register=function(t,n){var o=n.metadata,r={};r[e.BaseCustomElementBridge.DESC_KEY_META]=o,r._CONSTRUCTOR=n,e.BaseCustomElementBridge.__Register(t,r,c.proto)&&customElements.define(t.toLowerCase(),c.proto.getClass(r))},c._processSlotContent=function(t,n){var o=[];if(t.childNodes){t._nodeStorage||(t._nodeStorage=document.createElement("div"),t._nodeStorage.style.display="none",t.appendChild(t._nodeStorage));var r=[];Object.entries(n).forEach(function(t){var e=t[0];t[1].forEach(function(t){o.push(_(t,e)),r.push(t)})}),r.forEach(function(n){t._nodeStorage.appendChild(n),e.Components&&e.Components.subtreeHidden(n)})}return o},c.__SetProperty=function(t,n,o,r){var i,s=n,l=o.split("."),u=t(l[0]);l.length>1&&!n[u]&&(s=i={});for(var c=0;c<l.length;c++){var a=t(l[c]),_=s[a];c===l.length-1?s[a]=r:_?Object.isFrozen(_)&&(s[a]=e.CollectionUtils.copyInto({},_,void 0,!0)):s[a]={},s=s[a]}i&&(n[u]=i[u])},c._storeUnslottedNodes=function(t,n){n&&t._nodeStorage&&n.forEach(function(n){var o=n._node;o.isConnected||(t._nodeStorage.appendChild(o),e.Components&&e.Components.subtreeHidden(o))})},t.VComponent=class{constructor(t){this._pendingPropsUpdate=!1,this.props=t}updated(t,e){}mounted(){}unmounted(){}uniqueId(){return this._uniqueId}_updateProperty(t,e,n=!1){this.props[t]!==e&&this._getCallback("_updateProperty")(t,e,n)}updateState(t){this._pendingStateUpdaters||(this._pendingStateUpdaters=[]),this._pendingStateUpdaters.push(t),this.queueRender(this._ref,"stateUpdate")}mount(t,e,n={}){return this._vnode=this._renderForMount(t,e),this._ref=l.mount(this._vnode,!0)}patch(t,e,n,o){const r=this.props,i=this.state,s=this._vnode;this._vnode=this._renderForPatch(t,e),l.patch(this._vnode,s,this._ref.parentNode,!0),this.updated(r,i)}notifyMounted(){l.mounted(this._vnode),this.mounted()}notifyUnmounted(t){l.unmount(this._vnode),this.unmounted()}queueRender(t,e){if("propsUpdate"===e&&(this._pendingPropsUpdate=!0),!this._busyStateCallbackForRender){var o=n.getContext(t).getBusyContext();this._busyStateCallbackForRender=o.addBusyState({description:this.uniqueId()+" is waiting to render."}),window.requestAnimationFrame(()=>{const t=this._busyStateCallbackForRender,e=this._pendingPropsUpdate,n=this._pendingStateUpdaters;this._busyStateCallbackForRender=null,this._pendingPropsUpdate=!1,this._pendingStateUpdaters=null;try{const o=this._getCallback("getPropsForRender")(),r=this._doUpdateState(o,n);(e||r&&!this._areStatesEqual(this.state,r))&&(this._pendingState=r,this._getCallback("patch")(o,this._ref.parentNode))}catch(t){throw t}finally{t(),this._pendingState=null}})}}_renderForMount(t,e){if(this.state){const e=this.constructor.initStateFromProps;if(e){const n=e.call(this.constructor,t,this.state);this.state=this._getNewState(n)}}return this._render(t,e)}_renderForPatch(t,e){if(this.state){const e=this.constructor.updateStateFromProps;let n;e&&(n=e.call(this.constructor,t,this._pendingState||this.state,this.props)),this.state=this._getNewState(n,this._pendingState)}return this._render(t,e)}_render(t,e){return e&&e.length&&Object.assign(t,this._getCallback("convertChildrenToSlotProps")(e)),this.props=t,this.render()}_doUpdateState(t,e){return e&&0!==e.length?e.reduce((e,n)=>{const o="function"==typeof n?n(e,t):n;return Object.assign(e,o)},Object.assign({},this.state)):null}_areStatesEqual(t,e){return Object.keys(e).every(n=>t[n]===e[n])}_getCallback(t){return this._callbacks||(this._callbacks=this._getBuiltInCallbacks()),this._callbacks[t]}_getBuiltInCallbacks(){const t={_updateProperty:(t,n)=>{var o,r;const i=e.__AttributeUtils.propertyNameToChangeEventType(t),s=e.__AttributeUtils.eventTypeToEventListenerProperty(i);null===(r=(o=this.props)[s])||void 0===r||r.call(o,{value:n,previousValue:this.props[t],updatedFrom:"internal"})},getPropsForRender:()=>this.props,patch:(t,e)=>{this.patch(t,e)},convertChildrenToSlotProps:function(t){return{children:t}},_vcomp:!0};return t}_getNewState(t,e=null){return t||e?Object.assign({},e||this.state,t):this.state}},t._writeback=function({readOnly:t}={readOnly:!1}){return(t,e)=>{}},t.classPropToObject=s,t.customElement=function(t){return function(n){const o=n.prototype.render;function r(t,n){var o,r=(null===(o=n.extension)||void 0===o?void 0:o._ROOT_PROPS_MAP)||{};return{class:!0,style:!0,ref:!0,key:!0}[t]||r[t]||null!==e.__AttributeUtils.eventListenerPropertyToEventType(t)}n.prototype.render=function(){let e=o.call(this);return e.type!==t&&(e=l.h(t,null,e)),function(t,e){for(var n in t)if(!r(n,e))throw new Error("Component can only render controlled global properties or DOM event listeners on the root custom element. "+n+" will not be rendered.")}(e.props,n.metadata),e},n.prototype.mount=function(t,e,n){this._vnode=this._renderForMount(t,e);const o=this._ref=l.mountCustomElement(this._vnode,n);return Object.defineProperty(o,"_vcomp",{value:this,enumerable:!1}),o},n.prototype.patch=function(t,e,n,o){const r=this.props,i=this.state,s=this._vnode;this._vnode=this._renderForPatch(t,e),this._vnode._node=this._ref,this._patching=!0;try{l.patchCustomElement(this._vnode,s,n,o)}finally{this._patching=!1}this.updated(r,i)},n.prototype.mountContent=function(t,e,n,o){this._isCustomElementFirst=!0,this._ref=n,this._vnode=this._renderForMount(t,e),this._vnode._node=n,this._patching=!0;try{l.mountCustomElementContent(this._vnode,o)}finally{this._patching=!1}},n.prototype.patchContent=function(t,e,n){const o=this.props,r=this.state,i=this._vnode;this._vnode=this._renderForPatch(t,n),this._vnode._node=this._ref,this._patching=!0;try{l.patchCustomElementContent(this._vnode,i,e)}finally{this._patching=!1}this.updated(o,r)},n.prototype.setCallbacks=function(t){this._callbacks=t},n.prototype.isCustomElementFirst=function(){return!0===this._isCustomElementFirst},n.prototype.isPatching=function(){return this._patching},c.register(t,n)}},t.dynamicDefault=function(t){return(e,n)=>{const o=Symbol();return{get(){const e=this[o];return void 0===e?t():e},set(t){this[o]=t}}}},t.event=function({bubbles:t}={bubbles:!1}){return(t,e)=>{}},t.h=u,t.listener=function(t){return function(e,n,o){let r=null==o?void 0:o.value;return{configurable:!0,get(){const e=r.bind(this);return e[l.LISTENER_OPTIONS_SYMBOL]=t,Object.defineProperty(this,n,{configurable:!0,get:()=>e,set(t){r=t,delete this[n]}}),e},set(t){r=t}}}},t.method=function(){return function(t,e,n){}},t.rootProperty=function(){return(t,e)=>{}},Object.defineProperty(t,"__esModule",{value:!0})});